version: 1
default_environment: dev
project_id: adventureworks-meltano

environments:
  - name: dev

plugins:
  extractors:
    - name: tap-postgres
      variant: meltanolabs
      pip_url: meltanolabs-tap-postgres
      config:
        host: source-db
        port: 5432
        user: postgres
        password: password
        database: Adventureworks
        filter_schemas:
          - Sales
          - Production
          - Person
          - HumanResources
        replication_method: FULL_TABLE

  loaders:
    - name: target-postgres
      variant: transferwise
      pip_url: pipelinewise-target-postgres
      config:
        host: warehouse-db
        port: 5432
        user: dwh_user
        password: dwh_password
        dbname: warehouse
        # Each OLTP schema lands in its own raw_* schema
        schema_mapping:
          Sales:
            target_schema: raw_sales
          Production:
            target_schema: raw_production
          Person:
            target_schema: raw_person
          HumanResources:
            target_schema: raw_humanresources
        add_metadata_columns: true      # adds _sdc_received_at, _sdc_sequence, etc.
        hard_delete: false
        data_flattening_max_level: 4

schedules:
  - name: adw-daily-el
    extractor: tap-postgres
    loader: target-postgres
    transform: skip
    interval: "@daily"
    start_date: 2024-01-01 00:00:00
